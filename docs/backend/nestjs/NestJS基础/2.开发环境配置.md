### ä¸€.é¡¹ç›®éœ€æ±‚åˆ†æ

------



- æ¥å£æœåŠ¡ï¼šæä¾›å¯é ã€å¯æ‰©å±•çš„WEBæœåŠ¡ï¼Œé›†æˆæ•°æ®åº“+Redis

- å®ç°æœ€å°é—­ç¯ï¼šæ¥å£CURDã€ç™»é™†æ³¨å†Œï¼ˆè®¤è¯ï¼‰ã€æƒé™æ§åˆ¶ï¼ˆé‰´æƒï¼‰

- æœåŠ¡éƒ¨ç½²ä¸æµ‹è¯• - > æä¾›æ–‡æ¡£ï¼ˆéœ€æ±‚ã€æµ‹è¯•ã€éƒ¨ç½²ã€äº§å“...ï¼‰

  

### äºŒ.é¡¹ç›®æŠ€æœ¯æ ˆ

------



- Nest.js+TypeScriptä½œä¸ºåç«¯

- ORMåº“ï¼šType ORM - > å®˜æ–¹çš„æ•°æ®åº“å¯¹æ¥æ–¹æ¡ˆ
  
- Bootstrap 5.x + Vueä½œä¸ºå‰ç«¯æ–¹æ¡ˆ

> **å¼€å‘æ€è·¯ï¼šç”±ç®€å…¥ç¹ï¼Œæœ€å°ç¯ä¸ºä¸»**



###  ä¸‰.å¤šç¯å¢ƒé…ç½® -> ç”Ÿäº§&æµ‹è¯• 

------

â€‹	![image-20230912102258076](https://cdn.staticaly.com/gh/zhu325/markdown-img@main/blog/image-20230912102258076.png)

åœ¨é¡¹ç›®ä¸­ï¼Œåˆ†äº†å¼€å‘ã€æµ‹è¯•ã€é¢„ç”Ÿäº§ã€ç”Ÿäº§å››ä¸ªç¯å¢ƒï¼Œä¹‹å‰åˆ‡æ¢ç¯å¢ƒï¼Œæ˜¯åœ¨é¡¹ç›®ä¸­çš„é…ç½®ç±»ä¸­ï¼Œç”¨ä¸€ä¸ªå®å®šä¹‰ï¼Œè¿›è¡Œç¯å¢ƒçš„åˆ‡æ¢ï¼Œæ¯æ¬¡åˆ‡æ¢ç¯å¢ƒéƒ½è¦ä¿®æ”¹ä»£ç ï¼Œæœ‰æ—¶è¿˜ä¼šè¢«å¼€å‘äººå‘˜æäº¤åˆ°Gitä¸­ï¼Œé€ æˆä»£ç é—®é¢˜å’Œå†²çªã€‚æ‰€ä»¥å°±æœ‰äº†å¯¹é¡¹ç›®å·¥ç¨‹è¿›è¡Œå¤šç¯å¢ƒé…ç½®çš„éœ€æ±‚ã€‚


#### dotenv

`dotenv` æ˜¯ä¸€ä¸ªé›¶ä¾èµ–çš„æ¨¡å—ï¼Œå®ƒå°†ç¯å¢ƒå˜é‡ä»` .env` æ–‡ä»¶åŠ è½½åˆ°` process.env `ä¸­ã€‚

```bash
pnpm install dotenv --save
```

åœ¨ `Node.js` åº”ç”¨ç¨‹åºä¸­ï¼Œé€šå¸¸ä½¿ç”¨` .env `æ–‡ä»¶ï¼Œå…¶ä¸­åŒ…å«é”®å€¼å¯¹ï¼Œå…¶ä¸­æ¯ä¸ªé”®ä»£è¡¨ä¸€ä¸ªç‰¹å®šçš„å€¼ï¼Œä»¥ä»£è¡¨æ¯ä¸ªç¯å¢ƒã€‚ åœ¨ä¸åŒçš„ç¯å¢ƒä¸­è¿è¡Œåº”ç”¨ç¨‹åºä»…æ˜¯äº¤æ¢æ­£ç¡®çš„`.env` æ–‡ä»¶çš„é—®é¢˜ã€‚



#### js-yaml

```bash
pnpm install js-yaml
```

ä½¿ç”¨ç¤ºä¾‹ï¼š[æŸ¥çœ‹æ–‡æ¡£](https://www.npmjs.com/package/js-yaml)

```typescript
const yaml = require('js-yaml');
const fs   = require('fs');

// Get document, or throw exception on error
try {
  const doc = yaml.load(fs.readFileSync('/home/ixti/example.yml', 'utf8'));
  console.log(doc);
} catch (e) {
  console.log(e);
}
```



#### `config`è§£æjsoné…ç½®æ–‡ä»¶

> åˆ›å»ºé»˜è®¤ç¯å¢ƒå˜é‡

åˆ›å»ºä¸€ä¸ª `config` ç›®å½•å¹¶å‘å…¶ä¸­æ·»åŠ ä¸€ä¸ª `config/default.json` æ–‡ä»¶ã€‚è¿™å°†æ˜¯é»˜è®¤é…ç½®æ–‡ä»¶ï¼Œå¹¶å°†åŒ…å«æ‰€æœ‰é»˜è®¤ç¯å¢ƒå˜é‡ã€‚

åœ¨æˆ‘ä»¬çš„ç¤ºä¾‹åº”ç”¨ç¨‹åºä¸­å®ƒåº”è¯¥æ˜¯è¿™æ ·çš„ï¼š

config/default.json

```json
{
  "server": {
    "host": "localhost",
    "port": 0,
  }
}
```

æˆ‘ä»¬å°†åœ¨æˆ‘ä»¬çš„åº”ç”¨ç¨‹åºä¸­é€šè¿‡å¯¼å…¥ `config` å’Œä½¿ç”¨ `get` æ–¹æ³•è®¿é—®å˜é‡æ¥è®¿é—®å®ƒã€‚

```typescript
const config = require('config');
const port = config.get('server.port');
const host = config.get('server.host');
```

è®©æˆ‘ä»¬åˆ›å»ºä¸€ä¸ª `server.ts` æ–‡ä»¶å¹¶æ·»åŠ ä»¥ä¸‹ä»£ç ã€‚

```typescript
const express = require('express');
const config = require('config');
const app = express();
const port = config.get('server.port');
const host = config.get('server.host');

app.get('/', (req, res) => {
  res.send('Hello World');
});
const server = app.listen(port, host, (err) => {
  if (err) {
    console.log(err);
    process.exit(1);
  }
  console.log(`Server is running on ${host}:${server.address().port}`);
});
```

ä½ å¯ä»¥åœ¨ä½ çš„åº”ç”¨ç¨‹åºçš„å…¶ä»–éƒ¨åˆ†ä»¥ç±»ä¼¼çš„æ–¹å¼ä½¿ç”¨node-configã€‚



#### `Joi`ç”¨æ³•

**é…ç½®éªŒè¯**

é…ç½®éªŒè¯ï¼Œä¸»è¦æ˜¯æŒ‡åœ¨åº”ç”¨ç¨‹åºå¯åŠ¨æ—¶ï¼Œå¦‚æœæ²¡æœ‰æä¾›æ‰€éœ€çš„ç¯å¢ƒå˜é‡æˆ–ä¸åˆ¶åˆæŸäº›éªŒè¯è§„åˆ™ï¼Œå°±ä¼šæŠ›å‡ºä¸€ä¸ªå¼‚å¸¸ã€‚@nestjs/configåŒ…å®ç°äº†ä¸¤ç§ä¸åŒçš„æ–¹å¼ç±³å®ç°è¿™ä¸€ç‚¹ã€‚

ç‰¹åˆ«è¯´æ˜ï¼š

- æœ€æ–°ç‰ˆæœ¬çš„ `Joi`éœ€è¦è¿è¡ŒNode v12æˆ–æ›´é«˜ç‰ˆæœ¬ã€‚æ—§ç‰ˆæœ¬çš„nodeè¯·å®‰è£…`v16.1.8`ã€‚è¿™ä¸»è¦æ˜¯å› ä¸ºåœ¨`v17.0.2`å‘å¸ƒåï¼Œåœ¨æ„å»ºçš„æ—¶å€™ä¼šå‡ºç°é”™è¯¯ã€‚æ›´å¤šä¿¡æ¯è¯·å‚è€ƒå…¶17.0.0å‘å¸ƒè¯´æ˜ã€‚
- `Joi`æœ€å¥½é…åˆå®˜æ–¹çš„ `@nestjs/config` è¿›è¡Œä½¿ç”¨

æ­¥éª¤ï¼š

- å®‰è£…ä¾èµ–

  ```bash
  pnpm install --save joi
  pnpm install --save-dev @types/joi
  ```

- [Joi](https://github.com/sideway/joi) åº“å…è®¸ä½¿ç”¨å¯è¯»çš„ API ä»¥ç›´æ¥çš„æ–¹å¼åˆ›å»º schemaï¼Œæ„å»ºä¸€ä¸ªåŸºäº Joi schema çš„éªŒè¯ç®¡é“


  è¿™é‡Œä¸€å®šè¦`import * as Joi from 'joi'`
  ```typescript
  // import Joi from 'joi' || ğŸ™…
  import * as Joi from 'joi'
  ```

  ```typescript
  import { PipeTransform, Injectable, ArgumentMetadata, BadRequestException } from '@nestjs/common';
  import { ObjectSchema } from 'joi';
  
  @Injectable()
  export class JoiValidationPipe implements PipeTransform {
    constructor(private schema: ObjectSchema) {}
    
    transform(value: any, metadata: ArgumentMetadata) {
      const { error } = this.schema.validate(value);
      if (error) {
        throw new BadRequestException('Validation failed');
      }
      return value;
    }
  }
  ```

  







